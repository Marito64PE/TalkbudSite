<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TalkBud Demo</title>
<style>
    body {
        font-family: 'Segoe UI', sans-serif;
        background-color: #0f172a;
        color: #e2e8f0;
        margin: 0;
        padding: 0;
        text-align: center;
    }
    header {
        padding: 20px;
        background-color: #1e293b;
        font-size: 1.5rem;
        font-weight: bold;
        color: #38bdf8;
    }
    main {
        max-width: 800px;
        margin: auto;
        padding: 20px;
    }
    textarea {
        width: 100%;
        padding: 10px;
        background: #1e293b;
        color: #fff;
        border: none;
        border-radius: 8px;
        resize: none;
        margin-bottom: 15px;
    }
    button {
        padding: 12px 18px;
        margin: 8px;
        background: #38bdf8;
        color: #0f172a;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        transition: 0.2s;
    }
    button:hover {
        background: #0ea5e9;
    }
    .section {
        margin-top: 40px;
        text-align: left;
    }
    .section h2 {
        color: #38bdf8;
    }
    audio {
        margin-top: 15px;
    }
</style>
</head>
<body>
    <header>TalkBud Demo</header>
    <main>
        <h2>Texto a Audio (TTS)</h2>
        <textarea id="text" rows="4" placeholder="Escribe el texto que quieres convertir en audio..."></textarea><br>
        <button onclick="convertToAudio()">Convertir y Descargar</button>
        <audio id="audioPlayer" controls></audio>

        <div class="section">
            <h2>Grabaci√≥n desde Micr√≥fono</h2>
            <button onclick="startRecording()">üéô Iniciar Grabaci√≥n</button>
            <button onclick="stopRecording()">‚èπ Detener Grabaci√≥n</button>
            <audio id="recordedAudio" controls></audio>
        </div>

        <div class="section">
            <h2>C√≥mo subir los audios al dispositivo</h2>
            <ol>
                <li>Conecta el dispositivo a tu computadora mediante cable USB.</li>
                <li>Enci√©ndelo para que aparezca en el explorador de archivos.</li>
                <li>Copia y pega los archivos de audio descargados o grabados.</li>
                <li>Puedes a√±adir varios audios, incluso grabaciones propias.</li>
                <li>Los audios se reproducen en orden alfab√©tico.</li>
                <li>Modos de reproducci√≥n:
                    <ul>
                        <li><b>Modo 1:</b> Reproduce un audio y se detiene.</li>
                        <li><b>Modo 2:</b> Reproduce todos los audios y se detiene.</li>
                        <li><b>Modo 3:</b> Reproduce todos los audios en bucle.</li>
                    </ul>
                </li>
            </ol>
        </div>
    </main>

<script>
    function convertToAudio() {
        const text = document.getElementById("text").value;
        if (!text) {
            alert("Por favor escribe un texto.");
            return;
        }
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = "es-ES";
        speechSynthesis.speak(utterance);

        // Crear archivo de audio descargable (solo simulado)
        const blob = new Blob([text], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = "audio.txt"; // No se puede guardar directamente como mp3 desde TTS nativo
        a.click();
    }

    let mediaRecorder;
    let audioChunks = [];

    async function startRecording() {
        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
        mediaRecorder = new MediaRecorder(stream);
        audioChunks = [];
        mediaRecorder.ondataavailable = event => {
            audioChunks.push(event.data);
        };
        mediaRecorder.start();
    }

    function stopRecording() {
        mediaRecorder.stop();
        mediaRecorder.onstop = () => {
            const audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
            const audioUrl = URL.createObjectURL(audioBlob);
            document.getElementById("recordedAudio").src = audioUrl;

            // Descargar el audio grabado
            const a = document.createElement('a');
            a.href = audioUrl;
            a.download = "grabacion.webm";
            a.click();
        };
    }
</script>
</body>
</html>
